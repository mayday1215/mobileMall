webpackJsonp([16],{"79fi":function(t,s,r){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e={data:function(){var t=[];return sessionStorage.buyProducts?t=JSON.parse(sessionStorage.buyProducts):this.$Toast("加载购买商品信息错误"),{showPayPassword:!1,payPassword:"",orderId:-1,orderProductList:t}},watch:{payPassword:{handler:function(t){var s=this;t.length>=6&&this.$axios.post("/order/pay?order_id="+this.orderId,{pay_password:t}).then(function(t){s.payPassword="",0===t.errcode?s.$router.push({name:"paySuccess",query:{orderId:s.orderId}}):901201===t.errcode?s.$Toast(t.errmsg):s.$router.push({name:"payFail",query:{orderId:s.orderId}})})}}},computed:{address:function(){return this.$store.chosenAddress.id?{title:this.$store.chosenAddress.name+", "+this.$store.chosenAddress.mobile,label:this.$store.chosenAddress.province+" "+this.$store.chosenAddress.city+" "+this.$store.chosenAddress.country+" "+this.$store.chosenAddress.detail}:{title:"请选择收货地址",label:""}},totalPrice:function(){var t=0;return 100*this.orderProductList.reduce(function(s,r){return t+=r.price*r.count},t)},cart:function(){return this.$store.cart},productCounts:function(){var t=0;return this.orderProductList.reduce(function(s,r,e){return t+=r.count},t)},addressList:function(){return this.$store.addressList}},mounted:function(){},methods:{cancelPay:function(){this.showPayPassword=!1,this.$router.push({name:"order",params:{id:this.orderId}})},pay:function(){var t=this;this.$store.chosenAddress.id?this.$axios.post("/order/create",{orderProductList:this.orderProductList,user_address_id:this.$store.chosenAddress.id}).then(function(s){if(0===s.errcode){t.orderId=s.data.id,t.showPayPassword=!0;for(var r=0;r<t.$store.cart.length;r++)t.$store.cart[r].checked&&(t.$store.cart.splice(r,1),r--)}else t.$Toast(s.errmsg)}):this.$Toast("请填写收货地址")},onInput:function(t){this.payPassword=(this.payPassword+t).slice(0,6)},onDelete:function(){this.payPassword=this.payPassword.slice(0,this.payPassword.length-1)}}},o={render:function(){var t=this,s=t.$createElement,r=t._self._c||s;return r("div",[r("van-nav-bar",{attrs:{title:"结算","left-arrow":"","left-text":"返回"},on:{"click-left":function(s){return t.$router.back()}}}),t._v(" "),r("div",{staticClass:"list"},[r("van-cell-group",{staticClass:"item-gap"},[r("van-cell",{attrs:{title:t.address.title,label:t.address.label,"is-link":""},on:{click:function(s){return t.$router.push({name:"addressList"})}}})],1),t._v(" "),r("van-cell-group",{staticClass:"item-gap"},t._l(t.orderProductList,function(t){return r("van-cell",{key:t.id,attrs:{title:t.name,value:t.count+"件",label:"￥"+t.price,icon:t.cover}})}),1)],1),t._v(" "),r("van-submit-bar",{attrs:{price:t.totalPrice,loading:t.$store.isLoading,disabled:0===t.productCounts,"button-text":"付款"},on:{submit:t.pay}},[t._v("共"+t._s(t.productCounts)+"件\n  ")]),t._v(" "),r("van-popup",{staticClass:"van-popup-pay",attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:t.showPayPassword,callback:function(s){t.showPayPassword=s},expression:"showPayPassword"}},[r("van-nav-bar",{staticClass:"pay-nav-bar",attrs:{title:"付款"},on:{"click-left":t.cancelPay}},[r("van-icon",{attrs:{slot:"left",name:"cross"},slot:"left"})],1),t._v(" "),r("van-password-input",{attrs:{value:t.payPassword,info:"密码为 6 位数字"}}),t._v(" "),r("van-number-keyboard",{attrs:{show:t.showPayPassword},on:{input:t.onInput,delete:t.onDelete}})],1)],1)},staticRenderFns:[]};var a=r("VU/8")(e,o,!1,function(t){r("YMEn")},"data-v-4e02d148",null);s.default=a.exports},YMEn:function(t,s){}});
//# sourceMappingURL=16.9006941c26e47759a038.js.map